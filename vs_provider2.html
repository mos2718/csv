<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<title>上傳體溫 Observation 至 FHIR Server</title>
</head>
<body>
<h2>輸入體溫並上傳至 HAPI FHIR Server</h2>
<p>FHIR Server: https://hapi.fhir.org/baseR4/</p>
<p>Patient ID: 49410276</p>

<label>體溫(°C): <input id="temp" type="number" step="0.1" value="36.5"></label>
<button onclick="uploadObservation()">上傳</button>

<pre id="result"></pre>

<script>
async function uploadObservation() {
  const value = parseFloat(document.getElementById('temp').value);
  const observation = {
    resourceType: "Observation",
    status: "final",
    category: [{ coding: [{ system: "http://terminology.hl7.org/CodeSystem/observation-category", code: "vital-signs" }] }],
    code: { coding: [{ system: "http://loinc.org", code: "8310-5", display: "Body temperature" }] },
    subject: { reference: "Patient/49410276" },
    effectiveDateTime: new Date().toISOString(),
    valueQuantity: { value: value, unit: "°C", system: "http://unitsofmeasure.org", code: "Cel" }
  };

  const response = await fetch('https://hapi.fhir.org/baseR4/Observation', {
    method: 'POST',
    headers: { 'Content-Type': 'application/fhir+json' },
    body: JSON.stringify(observation)
  });

  const data = await response.json();
  document.getElementById('result').textContent = JSON.stringify(data, null, 2);
}
</script>
</body>
</html>